<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with metapopulations • aae.pop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with metapopulations">
<meta property="og:description" content="aae.pop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aae.pop</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/get_started.html">get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/including_processes.html">Including processes</a>
    </li>
    <li>
      <a href="../articles/beyond_defaults.html">Beyond defaults</a>
    </li>
    <li>
      <a href="../articles/metapopulations.html">Metapopulations</a>
    </li>
    <li>
      <a href="../articles/multiple_species.html">Multiple species</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/macperch_example.html">Macquarie perch</a>
    </li>
    <li>
      <a href="../articles/scenarios_example.html">Comparing scenarios</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">documentation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aae-stats/aae.pop">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with metapopulations</h1>
                        <h4 class="author">Jian Yen</h4>
            
            <h4 class="date">9/11/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aae-stats/aae.pop/blob/master/vignettes/metapopulations.Rmd"><code>vignettes/metapopulations.Rmd</code></a></small>
      <div class="hidden name"><code>metapopulations.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p><code>aae.pop</code> has a built-in method to define a metapopulation from multiple populations. This is based on the most-general definition of a metapopulation: populations of the same species connected by dispersal. Defining a metapopulation requires <code>dynamics</code> objects for multiple populations, a <code>structure</code> that defines movements between populations, and a <code>dispersal</code> object, which is a new class of object used to specify in detail the movements between populations.</p>
<p>This vignette introduces <code>structure</code> and <code>dispersal</code> objects and explains how population processes (e.g., demograhic stochasticity) are handled in metapopulations.</p>
</div>
<div id="defining-a-metapopulation" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-a-metapopulation" class="anchor"></a>Defining a metapopulation</h2>
<p>Simulating metapopulation dynamics is very similar to the basic <code>simulate</code> approach outlined in the <a href="get_started.html">Getting started</a> vignette. The only difference is that the population matrix has to be expanded to include multiple populations and movements among these populations. This section will start with a highly simplified example of a building a metapopulation from scratch and will then introduce some methods in <code>aae.pop</code> to streamline this process for more realistic population models.</p>
<p>First, define a simplistic two-class model:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">popmat_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">0</span>, <span class="fl">2</span>,       <span class="co"># reproduction of 10 new individuals per adult (female)</span>
    <span class="fl">0.45</span>, <span class="fl">0.15</span>  <span class="co"># move from class 1 to class 2 with 0.8 probability,</span>
                <span class="co"># survive in class 2 with 0.25 probability</span>
  <span class="op">)</span>,
  nrow <span class="op">=</span> <span class="fl">2</span>,
  byrow <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></pre></div>
<p>If we assume there are two separate populations with same underlying vital rates (defined in <code>popmat_simple</code>), it is possible to build up a four-class model that has two classes from population 1 and another two classes from population 2:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># setup a matrix with four classes and all elements equal to zero</span>
<span class="va">metapop_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>

<span class="co"># fill the first population's vital rates</span>
<span class="co">#   (top two rows, two left-hand columns)</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">popmat_simple</span>

<span class="co"># repeat for the second population, this time</span>
<span class="co">#   filling the bottom right square</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">popmat_simple</span></pre></div>
<p>This matrix defines transitions between all four classes (two classes each in two populations), but currently keeps transitions within populations. Following the <em>columns move to rows</em> rule of <code>aae.pop</code>, the <code>metapop_simple</code> matrix defines transitions from class 1 to class 2, class 2 to classes 1 and 2, class 3 to class 4, and class 4 to classes 3 and 4:</p>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.00 2.00 0.00 0.00
## [2,] 0.45 0.15 0.00 0.00
## [3,] 0.00 0.00 0.00 2.00
## [4,] 0.00 0.00 0.45 0.15</code></pre>
<p>Adding dispersal, or movement between the two populations, requires transitions from class 1 or 2 to class 3 or 4, and vice versa. For example, dispersal might be a feature of the second class only (adults), in which case individuals would move between class 2 and class 4. These movements will be defined by cells <code>[2, 4]</code> and <code>[4, 2]</code> in <code>metapop_simple</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># allow 30 % of surviving adults to move between populations</span>
<span class="co">#   (columns move to rows, so population 1 to 2 is in [4, 2] and</span>
<span class="co">#    population 2 to 1 is in [2, 4])</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span>

<span class="co"># this 30 % needs to be removed from the adults that survive</span>
<span class="co">#   and remain within the same population</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">metapop_simple</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">metapop_simple</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span>

<span class="co"># what happens if we simulate from this?</span>
<span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">metapop_simple</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">sims</span>, col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="metapopulations_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This plot sums over both populations, which is often of interest when considering species- or metapopulation-level abundances. <code>aae.pop</code> has a built-in <code>subset</code> method, which means it’s possible to separate the two populations, recalling that population 1 is classes 1 and 2 and population 2 is classes 3 and 4 in the population vector:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">pop1_sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">sims</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>
<span class="va">pop2_sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">sims</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">pop1_sims</span>, col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="metapopulations_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">pop2_sims</span>, col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="metapopulations_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>This illustrates a highly simplified metapopulation model, highlighting the main steps in its construction: define population dynamics of each separate population, define dispersal among populations, and account for the effects of dispersal on within-population vital rates. The following sections outline how these steps are generalised in <code>aae.pop</code> to deal with realistically complex models.</p>
<div id="structure" class="section level3">
<h3 class="hasAnchor">
<a href="#structure" class="anchor"></a>Structure</h3>
<p>The structure of a metapopulation defines how populations are connected. Structure is captured in <code>aae.pop</code> by a matrix of zeros and ones that denote links between two populations. This matrix has one row and one column for each population, and follows the same <em>columns move to rows</em> rule as the population matrix. For example, a 1 in the second row, first column, indicates that individuals from population 1 can move to population 2. A 1 in the first row, second column denotes the reverse movement (population 2 to population 1).</p>
<p>For the simplistic example above, the structure would look like:</p>
<pre><code>##      [,1] [,2]
## [1,]    0    1
## [2,]    1    0</code></pre>
<p>This structure can be defined as:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">structure_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
<p>Increasing the number of populations is a direct extension of this approach. With five populations all connected by dispersal, the structure would look like:</p>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    1    1    1    1
## [2,]    1    0    1    1    1
## [3,]    1    1    0    1    1
## [4,]    1    1    1    0    1
## [5,]    1    1    1    1    0</code></pre>
<p>A more realistic structure might consider five populations with only some of these possible connections, which might look like:</p>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    1    0    0    0
## [2,]    0    0    0    1    0
## [3,]    1    1    0    0    0
## [4,]    1    0    0    0    0
## [5,]    0    0    0    1    0</code></pre>
<p>In this example, individuals from population 1 move to populations 3 and 4, individuals from population 2 move to populations 1 and 3, and individuals from population 4 move to populations 2 and 5. Individuals from populations 3 and 5 never move to other populations.</p>
</div>
<div id="dispersal" class="section level3">
<h3 class="hasAnchor">
<a href="#dispersal" class="anchor"></a>Dispersal</h3>
<p>Defining the structure of a metapopulation is the first step towards simulating metapopulation dynamics. However, this definition of structure is biologically vague. It specifies which populations are connected and the direction of those connectons, but doesn’t specify which classes <em>within</em> populations are moving and how frequently. <code>dispersal</code> objects specify the probability of a transition between specific source and receiver classes, whether these transitions are density dependent, and any stochasticity in the transitions. <code>dispersal</code> objects are one-directional, which means a separate <code>dispersal</code> object is required for each link in the <code>structure</code> matrix.</p>
<p>Using the simplistic, two-class example, which had adults moving both directions between the two populations, the <code>dispersal</code> objects could be specified as:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">kern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">dispersal_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>kernel <span class="op">=</span> <span class="va">kern</span>, proportion <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>The <code>kernel</code> is a matrix with two rows and two columns, and the 0.3 in the bottom-right corner specifies the 30 % of surviving adults that move from one population to another. The argument <code>proportion</code> determines whether this 30 % of moving individuals is a proportion of all surviving adults or is an absolute value. Setting <code>proportion = TRUE</code> addresses the situation where the 30 % of moving adults are taken from the total pool of surviving adults, thereby reducing the within-population survival by 30 %. This setup is sufficient to specify a one-direction movement between populations; an additional <code>dispersal</code> term is required to specify the reverse transition. In <code>aae.pop</code>, these <code>dispersal</code> terms can be combined in a list, stored in column-major order following the metapopulation <code>structure</code>. This means that one <code>dispersal</code> object must be provided for each link in the <code>structure</code>, working through the columns from left-to-right (i.e., all links in column 1, all links in column 2, and so on). In this simplistic example, the same <code>dispersal</code> term can be used for both links:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">dispersal_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dispersal_simple</span>, <span class="va">dispersal_simple</span><span class="op">)</span></pre></div>
<p>This example presents a simplified dispersal setup. <code>aae.pop</code> supports more complex features such as stochasticity and density dependence in transitions. These two extensions are discussed briefly <a href="#advanceddispersal">below</a>.</p>
</div>
<div id="putting-it-all-together" class="section level3">
<h3 class="hasAnchor">
<a href="#putting-it-all-together" class="anchor"></a>Putting it all together</h3>
<p>Together, <code>popmat_simple</code>, <code>structure_simple</code>, and <code>dispersal_simple</code> are sufficient to characterise metapopulation dynamics as in <code>metapop_simple</code>. The <code>metapopulation</code> function ties these three elements together:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co"># create a population dynamics object from the population matrix</span>
<span class="va">dynamics_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">popmat_simple</span><span class="op">)</span>

<span class="co"># turn this into a metapopulation</span>
<span class="va">metapopulation_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metapopulation.html">metapopulation</a></span><span class="op">(</span>
  structure <span class="op">=</span> <span class="va">structure_simple</span>,
  dynamics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dynamics_simple</span>, <span class="va">dynamics_simple</span><span class="op">)</span>, <span class="co"># both populations have identical rates</span>
  dispersal <span class="op">=</span> <span class="va">dispersal_simple</span>
<span class="op">)</span></pre></div>
<p>The metapopulation defined by <code>metapopulation_simple</code> is identical to that defined by <code>metapop_simple</code>, above:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">metapop_simple</span>, <span class="va">metapopulation_simple</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>With <code>metapopulation_simple</code> defined in this way, simulating population dynamics is identical to any other population model in <code>aae.pop</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">metapopulation_simple</span>, nsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">sims</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="metapopulations_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">sims</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="metapopulations_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
</div>
</div>
<div id="what-happens-to-within-population-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#what-happens-to-within-population-processes" class="anchor"></a>What happens to within-population processes?</h2>
<p>The <code>metapopulation</code> function preserves all within-population processes, such as density dependence, environmental and demographic stochasticity, and covariate effects (but see below for <a href="#covarissues">one complication with covariates</a>). The processes operate within populations, so are largely separate from dispersal. Dispersal itself can be subject to among-population density dependence and stochasticity; this is described <a href="#advanceddispersal">below</a>.</p>
<p>Within-population processes are preserved using the same <code>mask</code>/<code>function</code> approach used for demographic processes, described in the <a href="including_processes.html">Including processes</a> vignette. A set of masks is created for each population (<em>blocks</em> on a <em>block-diagonal</em> matrix), and the functions for each population are coupled with the appropriate mask. This is an example of the flexibility of the <code>mask</code>/<code>function</code> approach.</p>
<p>A by-product of this setup is that processes (with the exception of dispersal) are assumed to be independent of all other populations. For example, density dependence will consider the number of individuals currently in a population but will not take into account the overall metapopulation abundance. If this level of detail is required, the <code>metapopulation</code> function could still be used to prepare the metapopulation-level elements (e.g., the metapopulation matrix, process functions), with additional processes added with metapopulation-level masks and functions (e.g., a new call to <code>density_dependence</code>).</p>
<div id="covarissues" class="section level3">
<h3 class="hasAnchor">
<a href="#covarissues" class="anchor"></a>A complication: covariates</h3>
<p>Why is this messy? (taking advantage of matrix methods used for single pops)</p>
<p>What can we do? (example in docs)</p>
</div>
</div>
<div id="advanceddispersal" class="section level2">
<h2 class="hasAnchor">
<a href="#advanceddispersal" class="anchor"></a>More on dispersal</h2>
<p>Definitions of stochasticity and density dependence for metapopulations.</p>
<p>Example.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://scholar.google.com.au/citations?user=oEmm1CMAAAAJ&amp;hl=en">Jian Yen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
