<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a metapopulation dynamics object — metapopulation • aae.pop</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a metapopulation dynamics object — metapopulation" />
<meta property="og:description" content="Define population dynamics for multiple populations of
  a single species linked by dispersal (a metapopulation)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aae.pop</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">get started</a>
</li>
<li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../articles/index.html">vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/aae-stats/aae.pop">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a metapopulation dynamics object</h1>
    
    <div class="hidden name"><code>metapopulation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Define population dynamics for multiple populations of
  a single species linked by dispersal (a metapopulation).</p>
    </div>

    <pre class="usage"><span class='fu'>metapopulation</span><span class='op'>(</span><span class='va'>structure</span>, <span class='va'>dynamics</span>, <span class='va'>dispersal</span><span class='op'>)</span>

<span class='fu'>is.metapopulation</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S3 method for metapopulation</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>structure</th>
      <td><p>binary or logical matrix denoting dispersal
links between populations. Columns move to rows, so a <code>1</code> or
<code>TRUE</code> in cell (a, b) denotes movement from population b
to population a</p></td>
    </tr>
    <tr>
      <th>dynamics</th>
      <td><p>a <code><a href='dynamics.html'>dynamics</a></code> object or list of dynamics objects
with one element for each population (each column/row of
<code>structure</code>). If a single dynamics object is
provided, it is recycled over all required populations</p></td>
    </tr>
    <tr>
      <th>dispersal</th>
      <td><p>object created with
<code><a href='dispersal.html'>dispersal</a></code>. <code>dispersal</code> objects
describe movements between populations and can include
class-specific movements and density-dependent movements</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a metapopulation object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored; included for consistency with print generic</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>metapopluation</code> function connects multiple
  populations through known dispersal probabilities, handling
  standardisations of dispersal probabilities (if required) and
  updating masks and functions for all processes defined within each
  population. Further details on the definition of dispersal terms
  are provided in <code><a href='dispersal.html'>dispersal</a></code>.</p>
<p>Covariates can be included in metapopulation models. The default
  behaviour is for all populations to share a single set of covariates,
  with covariate associations and masks defined separately for each
  population. A workaround to the assumption of shared covariates
  is included in the examples, below. Including covariates on dispersal
  probabilities requires covariate associations and masks defined
  on the combined metapopulation model. This approach is possible
  but currently untested.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># define some populations</span>
<span class='va'>dyn1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='templates.html'>murray_cod</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>dyn2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='templates.html'>murray_cod</a></span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>15000</span><span class='op'>)</span>
<span class='va'>dyn3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='templates.html'>murray_cod</a></span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>30000</span><span class='op'>)</span>

<span class='co'># define metapopulation structure with populations</span>
<span class='co'>#   1 and 3 dispersing into population 2</span>
<span class='va'>mc_structure</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='fl'>3</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>mc_structure</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>mc_structure</span><span class='op'>[</span><span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='co'># define dispersal between populations</span>
<span class='va'>nclass</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>dyn1</span><span class='op'>$</span><span class='va'>matrix</span><span class='op'>)</span>
<span class='va'>dispersal_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>nclass</span>, ncol <span class='op'>=</span> <span class='va'>nclass</span><span class='op'>)</span>
<span class='va'>dispersal_matrix</span><span class='op'>[</span><span class='fu'><a href='masks.html'>survival</a></span><span class='op'>(</span><span class='va'>dispersal_matrix</span>, dims <span class='op'>=</span> <span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0.2</span>
<span class='va'>mc_dispersal1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dispersal.html'>dispersal</a></span><span class='op'>(</span><span class='va'>dispersal_matrix</span>, proportion <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>mc_dispersal2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dispersal.html'>dispersal</a></span><span class='op'>(</span><span class='va'>dispersal_matrix</span>, proportion <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>mc_dispersal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>mc_dispersal1</span>, <span class='va'>mc_dispersal2</span><span class='op'>)</span>

<span class='co'># create metapopulation object</span>
<span class='va'>mc_meta</span> <span class='op'>&lt;-</span> <span class='fu'>metapopulation</span><span class='op'>(</span><span class='va'>mc_structure</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>dyn1</span>, <span class='va'>dyn2</span>, <span class='va'>dyn3</span><span class='op'>)</span>, <span class='va'>mc_dispersal</span><span class='op'>)</span>

<span class='co'># simulate without covariates</span>
<span class='va'>sims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>mc_meta</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># simulate with shared covariates</span>
<span class='co'>#  (uses pre-defined Murray cod covariate function)</span>
<span class='va'>xsim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>sims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>mc_meta</span>, nsim <span class='op'>=</span> <span class='fl'>2</span>, args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>covariates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>xsim</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># simulate with separate covariates</span>
<span class='co'>#  (requires re-definition of Murray cod covariate function)</span>
<span class='va'>new_fn1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mat</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>new_fn2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mat</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>new_fn3</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>mat</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>dyn1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>dyn1</span>, <span class='fu'><a href='covariates.html'>covariates</a></span><span class='op'>(</span>masks <span class='op'>=</span> <span class='fu'><a href='masks.html'>transition</a></span><span class='op'>(</span><span class='va'>dyn1</span><span class='op'>$</span><span class='va'>matrix</span><span class='op'>)</span>, funs <span class='op'>=</span> <span class='va'>new_fn1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dyn2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>dyn2</span>, <span class='fu'><a href='covariates.html'>covariates</a></span><span class='op'>(</span>masks <span class='op'>=</span> <span class='fu'><a href='masks.html'>transition</a></span><span class='op'>(</span><span class='va'>dyn2</span><span class='op'>$</span><span class='va'>matrix</span><span class='op'>)</span>, funs <span class='op'>=</span> <span class='va'>new_fn2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dyn3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>dyn3</span>, <span class='fu'><a href='covariates.html'>covariates</a></span><span class='op'>(</span>masks <span class='op'>=</span> <span class='fu'><a href='masks.html'>transition</a></span><span class='op'>(</span><span class='va'>dyn3</span><span class='op'>$</span><span class='va'>matrix</span><span class='op'>)</span>, funs <span class='op'>=</span> <span class='va'>new_fn3</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># (re)create metapopulation object</span>
<span class='va'>mc_meta</span> <span class='op'>&lt;-</span> <span class='fu'>metapopulation</span><span class='op'>(</span><span class='va'>mc_structure</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>dyn1</span>, <span class='va'>dyn2</span>, <span class='va'>dyn3</span><span class='op'>)</span>, <span class='va'>mc_dispersal</span><span class='op'>)</span>

<span class='co'># and simulate with one column of predictors for each population</span>
<span class='va'>xsim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>60</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>sims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>mc_meta</span>, nsim <span class='op'>=</span> <span class='fl'>2</span>, args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>covariates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>xsim</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://scholar.google.com.au/citations?user=oEmm1CMAAAAJ&hl=en'>Jian Yen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


