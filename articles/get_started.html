<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started with aae.pop • aae.pop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started with aae.pop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aae.pop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/get_started.html">get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/including_processes.html">Including processes</a>
    </li>
    <li>
      <a href="../articles/beyond_defaults.html">Beyond defaults</a>
    </li>
    <li>
      <a href="../articles/metapopulations.html">Metapopulations</a>
    </li>
    <li>
      <a href="../articles/multiple_species.html">Multiple species</a>
    </li>
    <li>
      <a href="../articles/templates.html">Species templates</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    examples

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/macperch_example.html">Macquarie perch</a>
    </li>
    <li>
      <a href="../articles/scenarios_example.html">Comparing scenarios</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aae-stats/aae.pop" class="external-link">
    <span class="fab fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="get_started_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="get_started_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="get_started_files/viz-1.8.2/viz.js"></script><link href="get_started_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="get_started_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started with aae.pop</h1>
                        <h4 data-toc-skip class="author">Jian Yen</h4>
            
            <h4 data-toc-skip class="date">01/07/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aae-stats/aae.pop/blob/main/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="hidden name"><code>get_started.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation-and-setup">Installation and setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a>
</h2>
<p>You can install the <code>aae.pop</code> package from GitHub. To
install from GitHub, you’ll need the <code>remotes</code> R package,
which you can install from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code></pre></div>
<p>You can then install the <code>aae.pop</code> package from Github
with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"aae-stats/aae.pop"</span><span class="op">)</span></span></code></pre></div>
<p>Once completed, you should be able to load the <code>aae.pop</code>
package with <code><a href="https://aae-stats/github.io/aae.pop">library(aae.pop)</a></code>.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="population-models">Population models<a class="anchor" aria-label="anchor" href="#population-models"></a>
</h3>
<p>The <code>aae.pop</code> package requires elementary knowledge of
population models. A comprehensive reference is Hal Caswell’s <em>Matrix
Population Models</em> (2nd edition, 2001, Sinauer Associates,
Sunderland). Searching for examples of <em>population viability
analysis</em>, <em>population demographic models</em>, or <em>matrix
population models</em> will bring up many alternative references.</p>
</div>
<div class="section level3">
<h3 id="matrix-structures">Matrix structures<a class="anchor" aria-label="anchor" href="#matrix-structures"></a>
</h3>
<p><code>aae.pop</code> is designed for generic matrix models and makes
minimal assumptions about model structure or purpose. However, there are
still some assumptions built into the different functions and
documentation. The most important is the layout of the population matrix
itself. <code>aae.pop</code> assumes that <em>columns move to rows</em>.
For example, a value in the second row and first column of a matrix will
specify a transition from stage 1 (column 1) to stage 2 (row 2), that
is, column 1 moves to row 2. This is a common layout in population
ecology but is not standard in all disciplines.</p>
<p>There are two population structures used frequently in population
ecology: the <em>Leslie matrix</em> (age based) and the <em>Lefkovitch
matrix</em> (life-stage based). A Leslie matrix classifies into age
classes, with transitions restricted to reproduction or survival to the
next age class. A Lefkovitch matrix classifies individuals into life
stages, with transitions restricted to reproduction, survival to the
next life stage, or survival but remaining in the same life stage.
<code>aae.pop</code> includes several helper functions designed
specifically for these two model types. These are described in the <a href="including_processes.html">Including processes</a> and <a href="beyond_defaults.html">Beyond defaults</a> vignettes.</p>
</div>
<div class="section level3">
<h3 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h3>
<p><code>aae.pop</code> uses three terms to help specify common model
structures: <em>reproduction</em>, <em>survival</em>, and
<em>transition</em>. These are defined as follows:</p>
<ul>
<li><p>reproduction: any transition to the first class (first row),
assumed to exclude the first column (i.e., new individuals can’t
reproduce).</p></li>
<li><p>survival: remaining in the same class.</p></li>
<li><p>transition: moving to the next age class or life stage.</p></li>
</ul>
<p>With these terms, a Leslie matrix has reproduction and transition
elements, whereas a Lefkovitch matrix has reproduction, transition, and
survival elements.</p>
<p>Of course, matrix population models can have values anywhere in a
matrix, and <code>aae.pop</code> supports any models represented as a
square matrix. This flexibility is important because some populations
might require complex structures to deal with things like
metapopulations, dormant stages, or size-based models with shrinkage as
well as growth.</p>
</div>
</div>
<div class="section level2">
<h2 id="building-a-basic-population-model">Building a basic population model<a class="anchor" aria-label="anchor" href="#building-a-basic-population-model"></a>
</h2>
<p>The central functions in <code>aae.pop</code> are
<code>dynamics</code> and <code>simulate</code>. The
<code>dynamics</code> function wraps up a population matrix and any
specified processes into a single object. The <code>simulate</code>
function takes this object and generates population projections.</p>
<div class="section level3">
<h3 id="the-population-matrix">The population matrix<a class="anchor" aria-label="anchor" href="#the-population-matrix"></a>
</h3>
<p>A good place to start is with a basic population matrix and no other
processes. For example, a Leslie matrix with five age classes can be
specified as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">2</span>,    <span class="fl">4</span>,    <span class="fl">7</span><span class="op">)</span>,  <span class="co"># reproduction from 3-5 year olds</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 1 to 2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0.45</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 2 to 3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.70</span>, <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 3 to 4</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.85</span>, <span class="fl">0</span><span class="op">)</span>   <span class="co"># survival from age 4 to 5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using the terminology above, this same matrix could be specified
as:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_offspring</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">transition_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.45</span>, <span class="fl">0.70</span>, <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="va">popmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">popmat</span><span class="op">[</span><span class="fu"><a href="../reference/masks.html">reproduction</a></span><span class="op">(</span><span class="va">popmat</span>, dims <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_offspring</span></span>
<span><span class="va">popmat</span><span class="op">[</span><span class="fu"><a href="../reference/masks.html">transition</a></span><span class="op">(</span><span class="va">popmat</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">transition_probabilities</span></span></code></pre></div>
<p>Although this looks fairly unwieldy in this case, these helper terms
can be useful with large matrices.</p>
</div>
<div class="section level3">
<h3 id="creating-a-population-dynamics-object">Creating a population <code>dynamics</code> object<a class="anchor" aria-label="anchor" href="#creating-a-population-dynamics-object"></a>
</h3>
<p>Once the population matrix is defined, it can be compiled into a
<code>dynamics</code> object with the following code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popdyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">popmat</span><span class="op">)</span></span></code></pre></div>
<p>It is possible to plot the population dynamics object to visualise
the transitions and structure this implies. This requires the
<code>DiagrammeR</code> package. Visualising population structures can
be a useful way to check the model has been specified correctly, and
these plots are easier to communicate than a giant matrix.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">popdyn</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\",\n       rankdir = \"LR\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"Age 1\", fontcolor = \"#4F7942\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#4F7942\", fillcolor = \"#4F794250\", width = \"0.9\", height = \"0.72\"] \n  \"2\" [label = \"Age 2\", fontcolor = \"#4F7942\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#4F7942\", fillcolor = \"#4F794250\", width = \"0.9\", height = \"0.72\"] \n  \"3\" [label = \"Age 3\", fontcolor = \"#0E4D92\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#0E4D92\", fillcolor = \"#0E4D9250\", width = \"0.9\", height = \"0.72\"] \n  \"4\" [label = \"Age 4\", fontcolor = \"#0E4D92\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#0E4D92\", fillcolor = \"#0E4D9250\", width = \"0.9\", height = \"0.72\"] \n  \"5\" [label = \"Age 5\", fontcolor = \"#0E4D92\", fontsize = \"12\", penwidth = \"2\", shape = \"circle\", color = \"#0E4D92\", fillcolor = \"#0E4D9250\", width = \"0.9\", height = \"0.72\"] \n\"1\"->\"2\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"transition\", style = \"solid\"] \n\"2\"->\"3\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"transition\", style = \"solid\"] \n\"3\"->\"1\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"reproduction\", style = \"dashed\"] \n\"3\"->\"4\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"transition\", style = \"solid\"] \n\"4\"->\"1\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"reproduction\", style = \"dashed\"] \n\"4\"->\"5\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"transition\", style = \"solid\"] \n\"5\"->\"1\" [color = \"Gainsboro\", fontname = \"Avenir\", fontcolor = \"LightGray\", fontsize = \"14\", penwidth = \"4\", label = \"reproduction\", style = \"dashed\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="simulating-population-trajectories">Simulating population trajectories<a class="anchor" aria-label="anchor" href="#simulating-population-trajectories"></a>
</h3>
<p>With a compiled <code>dynamics</code> object, it’s relatively
straightforward to simulate some population trajectories (with default
settings):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">popdyn</span><span class="op">)</span></span></code></pre></div>
<p>Simulated trajectories can be plotted using the standard
<code>plot</code> function in R. This example sets the colour to a
medium shade of blue:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sims</span>, col <span class="op">=</span> <span class="st">"#2171B5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="changing-default-settings">Changing default settings<a class="anchor" aria-label="anchor" href="#changing-default-settings"></a>
</h3>
<p>The default settings simulate a single trajectory with 50 time steps,
from random initial conditions (Poisson draws with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\lambda = 10</annotation></semantics></math>).
These settings can be changed directly in the call to
<code>simulate</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>  <span class="co"># some initial conditions</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">popdyn</span>,</span>
<span>                 nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                 init <span class="op">=</span> <span class="va">initials</span>,</span>
<span>                 options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ntime <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Default settings also specify that population updates are calculated
as a cross product and that abundances are not rounded in any way in
each step, which allows fractional individuals in the population. These
are not ideal settings. Changing them is covered in the <a href="beyond_defaults.html">Beyond defaults</a> vignette.</p>
</div>
<div class="section level3">
<h3 id="summarise-simulated-trajectories">Summarise simulated trajectories<a class="anchor" aria-label="anchor" href="#summarise-simulated-trajectories"></a>
</h3>
<p>Simulated trajectories are arrays with dimensions of replicates
(rows) by classes (columns) by time steps (slices). These arrays are
relatively easy to summarise using <code>apply</code> functions but the
<code>aae.pop</code> package includes several basic summary functions
for convenience.</p>
<p>A simple summary of the probability a population will hit zero
individuals at any time step, plus expected minimum population size
(EMPS), is generated with the <code>summary</code> function. This
summary makes most sense when considering replicate population
trajectories because extinction probabilities are defined as the
proportion of trajectories hitting zero individuals:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">popdyn</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simulated population has a 0 probability of extinction and expected minimum population size of 50 individuals.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The probability of population declines below non-zero thresholds is:</span></span>
<span><span class="co">##   n = 0  n = 28  n = 56  n = 84 n = 112 n = 140 n = 168 n = 196 n = 224 n = 252 </span></span>
<span><span class="co">##   0.000   0.001   0.798   1.000   1.000   1.000   1.000   1.000   1.000   1.000</span></span></code></pre>
<p>The vector printed at the bottom of this summary is a basic risk
curve calculated from ten different extinction thresholds (described
below).</p>
<p>The components of this summary are directly accessible:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pr_extinct.html">pr_extinct</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/emps.html">emps</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 50.06562</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/risk_curve.html">risk_curve</a></span><span class="op">(</span><span class="va">sims</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     0    28    56    84   112   140   168   196   224   252 </span></span>
<span><span class="co">## 0.000 0.001 0.798 1.000 1.000 1.000 1.000 1.000 1.000 1.000</span></span></code></pre>
<p>The default settings for <code>pr_extinct</code>, <code>emps</code>,
and <code>risk_curve</code> consider all population classes, all time
steps, and define extinction as zero individuals in the population. Many
applications require more-nuanced definitions. All three functions can
be calculated for a subset of the population (e.g., adults) and for a
reduced time period (e.g., generations 40-50).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pr_extinct.html">pr_extinct</a></span><span class="op">(</span><span class="va">sims</span>, subset <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/emps.html">emps</a></span><span class="op">(</span><span class="va">sims</span>, subset <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 20.28021</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/risk_curve.html">risk_curve</a></span><span class="op">(</span><span class="va">sims</span>, subset <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">:</span><span class="fl">50</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     0     4     8    11    15    19    23    26    30    34 </span></span>
<span><span class="co">## 0.000 0.000 0.000 0.001 0.037 0.322 0.778 0.973 0.999 1.000</span></span></code></pre>
<p>Extinction can be defined at levels other than zero individuals. For
example, a population might be considered functionally extinct or
destined to become extinct when only 100 adults remain. This
<em>quasi-extinction</em> threshold is controlled with the
<code>threshold</code> parameter to <code>pr_extinct</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pr_extinct.html">pr_extinct</a></span><span class="op">(</span><span class="va">sims</span>, threshold <span class="op">=</span> <span class="fl">100</span>, subset <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<p>Risk curves are an extension of the previous idea and consider
probabilities of population declines below multiple thresholds
simultaneously. The <code>summary</code> function calculates a basic
risk curve with ten thresholds spaced evenly between zero and the
maximum observed abundance. More commonly, risk curves focus on multiple
levels and might represent categories such as extreme, high, moderate,
mild, and no risk. These values could be based on many criteria but
often consider genetic factors such as the risk of inbreeding.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/risk_curve.html">risk_curve</a></span><span class="op">(</span><span class="va">sims</span>, threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     0    10    50   100  1000 </span></span>
<span><span class="co">## 0.000 0.000 0.476 1.000 1.000</span></span></code></pre>
<p>The <code>emps</code> function extracts the minimum population size
within each replicate trajectory and then averages these values over all
trajectories. This averaging defaults to an arithmetic mean but this can
be changed to any function using the <code>fun</code> argument (see
<code><a href="../reference/emps.html">?emps</a></code> for details). A generalisation of this calculation is
provided with the <code>exps</code> function, where <em>x</em>
represents an unknown function in place of the minimum. With few
exceptions, <code>emps</code> and <code>exps</code> require summary
functions that return single values (scalars). Even with this
restriction, <code>exps</code> allows flexible calculations to calculate
many different summary statistics. For example, it might be informative
to calculate the 95th percentile of each trajectory and then take the
median of this over all trajectories:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/exps.html">exps</a></span><span class="op">(</span><span class="va">sims</span>, fun_within <span class="op">=</span> <span class="va">quantile</span>, fun_among <span class="op">=</span> <span class="va">median</span>, probs <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 127.7357</span></span></code></pre>
<p>The above summary functions are provided for convenient handling of
details such as subsetting the population or time steps. More
complicated functions could be implemented directly with the
<code>apply</code> function and the output <code>simulation</code>
object. An example is the median population size at each time step:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset the population to adults </span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sims</span>, subset <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># drop the first 10 generations (the drop = FALSE</span></span>
<span><span class="co">#   argument is a safeguard that keeps the third array</span></span>
<span><span class="co">#   dimension when filtering to a single time step)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="va">sims</span><span class="op">[</span>, , <span class="fl">11</span><span class="op">:</span><span class="fl">51</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># sum abundances over all classes, which</span></span>
<span><span class="co">#   gives a matrix (2D array) with replicates</span></span>
<span><span class="co">#   in rows and time steps in columns</span></span>
<span><span class="va">abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sims</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># and calculate median over all trajectories, which</span></span>
<span><span class="co">#   requires keeping the second dimension (time steps)</span></span>
<span><span class="co">#   while iterating over the first</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">abundance</span>, <span class="fl">2</span>, <span class="va">median</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 19.27207 17.24090 18.36721 20.54079 19.83921 18.58626 18.49707 19.50724</span></span>
<span><span class="co">##  [9] 20.05605 19.31365 18.95322 19.32049 19.80666 19.74123 19.36984 19.42135</span></span>
<span><span class="co">## [17] 19.71964 19.84010 19.70977 19.61029 19.75668 19.92148 19.92292 19.86478</span></span>
<span><span class="co">## [25] 19.89903 20.01619 20.08203 20.07402 20.08156 20.14749 20.22133 20.25135</span></span>
<span><span class="co">## [33] 20.26481 20.30572 20.36663 20.41371 20.44123 20.47413 20.52307 20.57264</span></span>
<span><span class="co">## [41] 20.61077</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jian Yen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
