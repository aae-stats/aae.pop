<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Models of interacting species â€¢ aae.pop</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Models of interacting species">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aae.pop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get_started.html">get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/including_processes.html">Including processes</a></li>
    <li><a class="dropdown-item" href="../articles/beyond_defaults.html">Beyond defaults</a></li>
    <li><a class="dropdown-item" href="../articles/metapopulations.html">Metapopulations</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_species.html">Multiple species</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/macperch_example.html">Macquarie perch</a></li>
    <li><a class="dropdown-item" href="../articles/scenarios_example.html">Comparing scenarios</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../CODE_OF_CONDUCT.html">code of conduct</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aae-stats/aae.pop" aria-label="View source of GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Models of interacting species</h1>
                        <h4 data-toc-skip class="author">Jian Yen</h4>
            
            <h4 data-toc-skip class="date">07/01/2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aae-stats/aae.pop/blob/v0.2.0/vignettes/multiple_species.Rmd" class="external-link"><code>vignettes/multiple_species.Rmd</code></a></small>
      <div class="d-none name"><code>multiple_species.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><code>aae.pop</code> has two built-in functions to define population
dynamics of multiple, interacting species:
<code>pairwise_interaction</code> and <code>multispecies</code>. These
two functions can be used to create an extended <code>dynamics</code>
object, from which it is possible to <code>simulate</code> the dynamics
of all species simultaneously. Incorporating multiple species differs
from a single-population or metapopulation model primarily because the
different species are no longer assumed to have the same matrix
structure (e.g., they can differ in number of classes). Note that this
approach could also be used for multipopulation models of a single
species if this increased flexibility is required.</p>
<p>It is important to keep in mind that multispecies models are
difficult to parameterise due to a lack of knowledge of species
interactions, especially interactions among specific age or size
classes. In addition, complex multispecies models (e.g., including
covariates and other demographic processes) have not been tested
extensively and the functions and methods are likely to change following
further testing.</p>
</div>
<div class="section level2">
<h2 id="defining-species-interactions">Defining species interactions<a class="anchor" aria-label="anchor" href="#defining-species-interactions"></a>
</h2>
<p>The first requirement of a multispecies population model is a
definition of interactions among species. Without these interactions,
the simulated population dynamics will be identical to those simulated
with separate, single-species models. <code>aae.pop</code> assumes that
all interactions are pairwise, that is, species interactions do not
depend on the presence or abundance of a third species. Given the
difficulty of estimating pairwise interactions between species, it is
unlikely that models with higher-order interactions would be
reliable.</p>
<p>Species interactions can be defined with the
<code>pairwise_interaction</code> function. This function uses the
<code>mask</code>/<code>function</code> approach introduced in the <a href="including_processes.html">Including processes</a> vignette. The
<code>pairwise_interaction</code> function requires two additional
arguments: the population <code>dynamics</code> object for the
<em>target</em> population (species) and that of the <em>source</em>
population (species). Here, <em>target</em> refers to the species whose
vital rates are influenced by the abundances of the <em>source</em>
species.</p>
<p>Building the simple model introduced in the <a href="get_started.html">Getting started</a> vignette, consider a three
species system with the following population matrices:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define population matrices for three species</span></span>
<span><span class="va">sp1_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">2</span>,    <span class="fl">4</span>,    <span class="fl">7</span><span class="op">)</span>,  <span class="co"># reproduction from 3-5 year olds</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 1 to 2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0.45</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 2 to 3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.70</span>, <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 3 to 4</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.85</span>, <span class="fl">0</span><span class="op">)</span>   <span class="co"># survival from age 4 to 5</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sp2_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">4</span><span class="op">)</span>,  <span class="co"># reproduction from 3 year olds</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 1 to 2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0.45</span>, <span class="fl">0</span><span class="op">)</span>   <span class="co"># survival from age 2 to 3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sp3_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">2</span>,    <span class="fl">4</span>,    <span class="fl">7</span>,   <span class="fl">10</span><span class="op">)</span>,  <span class="co"># reproduction from 3-6 year olds</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 1 to 2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0.45</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 2 to 3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.70</span>, <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 3 to 4</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.85</span>, <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,  <span class="co"># survival from age 4 to 5</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span>   <span class="co"># survival from age 5 to 6</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can define population dynamics objects for each species and, with
these, define some interactions between species 1 and 3 and between
species 2 and 3:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define population dynamics objects for each species</span></span>
<span><span class="va">sp1_dyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">sp1_mat</span><span class="op">)</span></span>
<span><span class="va">sp2_dyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">sp2_mat</span><span class="op">)</span></span>
<span><span class="va">sp3_dyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamics.html">dynamics</a></span><span class="op">(</span><span class="va">sp3_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define multispecies interactions as masks/functions</span></span>
<span><span class="co"># - species 1 influencing transition probabilities of species 3</span></span>
<span><span class="va">mask_1v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/masks.html">transition</a></span><span class="op">(</span><span class="va">sp3_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># basic Beverton-Holt function</span></span>
<span><span class="va">fun_1v3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># n is the population vector of the source population (sp 1)</span></span>
<span>  <span class="va">x</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># focus on adults</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># - species 3 influencing reproduction of species 2</span></span>
<span><span class="va">mask_3v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/masks.html">reproduction</a></span><span class="op">(</span><span class="va">sp2_mat</span>, dims <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># basic Ricker function</span></span>
<span><span class="va">fun_3v2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># n is the population vector of the source population (sp 3)</span></span>
<span>  <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">50</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># focus on juveniles</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># combine masks and functions into pairwise_interaction objects</span></span>
<span><span class="va">sp_int1v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pairwise_interaction.html">pairwise_interaction</a></span><span class="op">(</span><span class="va">sp3_dyn</span>, <span class="va">sp1_dyn</span>, <span class="va">mask_1v3</span>, <span class="va">fun_1v3</span><span class="op">)</span></span>
<span><span class="va">sp_int3v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pairwise_interaction.html">pairwise_interaction</a></span><span class="op">(</span><span class="va">sp2_dyn</span>, <span class="va">sp3_dyn</span>, <span class="va">mask_3v2</span>, <span class="va">fun_3v2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulating-multispecies-dynamics">Simulating multispecies dynamics<a class="anchor" aria-label="anchor" href="#simulating-multispecies-dynamics"></a>
</h2>
<p>Once pairwise interactions are defined, the <code>multispecies</code>
function can be used to compile a dynamics object that can be passed to
<code>simulate</code>. Note that this function only sees the pairwise
interaction objects, so a <code>multispecies</code> dynamics object will
only include those species that interact directly with another
species.</p>
<p>Simulation of multispecies dynamics is very similar to the
single-species case. Some key exceptions are that initial conditions and
covariates (if provided) must be lists, with one element for each
species. A single set of initial conditions will still work if all
species have the same number of classes, in which case each species is
assumed to have the same initial conditions. Providing species-level
arguments for other processes is not currently possible but is a focus
of future development. In the simplest case, multispecies dynamics can
be simulated with default initial conditions and no additional
arguments:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compile a multispecies dynamics object</span></span>
<span><span class="va">multisp_dyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multispecies.html">multispecies</a></span><span class="op">(</span><span class="va">sp_int1v3</span>, <span class="va">sp_int3v2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">multisp_dyn</span>, nsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>In this case, the <code>simulate</code> function returns a list with
one element for each species. These individual elements can be handled
in the same way as single-species models, but <code>aae.pop</code> can
also work directly with the multispecies output. For example, the
<code>plot</code> function for a multispecies <code>simulation</code>
object will plot all species in separate plots by default, and takes an
optional <code>which</code> argument that specifies which species to
plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sims</span>, which <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.4</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Species 1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple_species_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="Line plots showing 100 simulated population trajectories for each species. Lines show Species 1 ranging from slight declines to slight increases, rapid extinction of Species 2, and stable abundances of Species 3 through time." width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sims</span>, which <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.4</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Species 2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple_species_files/figure-html/unnamed-chunk-4-2.png" class="r-plt" alt="Line plots showing 100 simulated population trajectories for each species. Lines show Species 1 ranging from slight declines to slight increases, rapid extinction of Species 2, and stable abundances of Species 3 through time." width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sims</span>, which <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"#2171B5"</span>, <span class="fl">0.4</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Species 3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple_species_files/figure-html/unnamed-chunk-4-3.png" class="r-plt" alt="Line plots showing 100 simulated population trajectories for each species. Lines show Species 1 ranging from slight declines to slight increases, rapid extinction of Species 2, and stable abundances of Species 3 through time." width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jian Yen, Arthur Rylah Institute for Environmental Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
